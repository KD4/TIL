Redis TTL 설정
========================

레디스에서 만료 시간, 즉 TTL(Time To Live)은 데이터가 얼마나 오래 저장될 것인지를 나타내는 시간 설정이다. 레디스는 데이터베이스 내의 특정 키에 대한 만료시간을 설정할 수 있으며, 이는 데이터의 유효 기간 또는 만료 시간을 정의하는 데 사용된다. 

만료 시간은 일반적으로 초 단위로 표현하고 설정한다.

```
> SET a 100
"OK"

> EXPIRE a 60
(integer) 1

> TTL a
(integer) 58
```

레디스에 저장된 키에 EXPIRE 커맨드를 사용하면 만료 시간을 설정할 수 있다. SET 커맨드로 string 데이터를 저장할 때에는 EX 옵션을 함께 사용해 데이터의 저장과 동시에 만료 시간을 설정할 수도 있다. TTL 커맨드로 키에 대한 만료 시간을 확인할 수도 있는데, 만료 시간이 남아 있다면 남은 시간을 반환하며, 키가 존재하지 않을 때에는 -2를, 키에 대한 만료 시간이 지정되지 않았을 경우에는 -1을 반환한다. 

레디스에서 키가 만료됐다고 해도 바로 메모리에서 삭제되는 것은 아니다. 키는 passive 방식과 active 방식, 두 가지로 삭제가 이뤄진다. (둘다 같이 동작함)

- passive 방식: 클라이언트가 키에 접근하고자 할 때 키가 만료됐다면 메모리에서 수동적으로 삭제한다. 사용자가 접근할 때만 수동적으로 삭제되기 때문에 passive 방식의 만료라 한다. 그러나 사용자가 다시 접근하지 않는 만료된 키도 있어 이 방식만으로 충분하지 않다.

- active 방식: TTL 값이 있는 키 중 20개를 랜덤하게 뽑아낸 뒤, 만료된 키를 모두 메모리에서 삭제한다. 만약 25% 이상의 키가 삭제됐다면 다시 20개의 키를 랜덤하게 뽑은 뒤 확인하고 아니라면 뽑아놓은 20개의 키 집합에서 다시 확인한다. 이러한 과정을 1초에 10씩 수행한다.